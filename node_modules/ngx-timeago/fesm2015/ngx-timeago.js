import { Injectable, Directive, Input, ElementRef, Optional, ChangeDetectorRef, Pipe, NgModule } from '@angular/core';
import { of, empty, timer, Subject } from 'rxjs';
import { expand, skip, filter } from 'rxjs/operators';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
/**
 * @param {?} value
 * @return {?}
 */
function isDefined(value) {
    return typeof value !== 'undefined' && value !== null;
}
/**
 * @param {?} value
 * @return {?}
 */
function coerceBooleanProperty(value) {
    return value != null && `${value}` !== 'false';
}
/**
 * @param {?} date
 * @return {?}
 */
function dateParser(date) {
    const /** @type {?} */ parsed = new Date(date);
    if (!Number.isNaN(parsed.valueOf())) {
        return parsed;
    }
    const /** @type {?} */ parts = String(date).match(/\d+/g);
    if (parts === null || parts.length <= 2) {
        return parsed;
    }
    else {
        const [firstP, secondP, ...restPs] = parts.map(x => parseInt(x, 10));
        return new Date(Date.UTC(firstP, secondP - 1, ...restPs));
    }
}
const /** @type {?} */ MINUTE = 60;
const /** @type {?} */ HOUR = MINUTE * 60;
const /** @type {?} */ DAY = HOUR * 24;
const /** @type {?} */ WEEK = DAY * 7;
const /** @type {?} */ MONTH = DAY * 30;
const /** @type {?} */ YEAR = DAY * 365;

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
/**
 * @abstract
 */
class TimeagoClock {
}
class TimeagoDefaultClock extends TimeagoClock {
    /**
     * @param {?} then
     * @return {?}
     */
    tick(then) {
        return of(0)
            .pipe(expand(() => {
            const /** @type {?} */ now = Date.now();
            const /** @type {?} */ seconds = Math.round(Math.abs(now - then) / 1000);
            const /** @type {?} */ period = seconds < MINUTE
                ? 1000
                : seconds < HOUR
                    ? 1000 * MINUTE
                    : seconds < DAY
                        ? 1000 * HOUR
                        : 0;
            return period ? timer(period) : empty();
        }), skip(1));
    }
}
TimeagoDefaultClock.decorators = [
    { type: Injectable },
];

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
/**
 * To modify the text displayed, create a new instance of TimeagoIntl and
 * include it in a custom provider
 */
class TimeagoIntl {
    constructor() {
        /**
         * Stream that emits whenever the l10n strings are changed
         * Use this to notify directives if the l10n strings have changed after initialization.
         */
        this.changes = new Subject();
    }
}
TimeagoIntl.decorators = [
    { type: Injectable },
];

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
const /** @type {?} */ defaultFormattter = function (then) {
    const /** @type {?} */ now = Date.now();
    const /** @type {?} */ seconds = Math.round(Math.abs(now - then) / 1000);
    const /** @type {?} */ suffix = then < now ? 'ago' : 'from now';
    const [value, unit] = seconds < MINUTE
        ? [Math.round(seconds), 'second']
        : seconds < HOUR
            ? [Math.round(seconds / MINUTE), 'minute']
            : seconds < DAY
                ? [Math.round(seconds / HOUR), 'hour']
                : seconds < WEEK
                    ? [Math.round(seconds / DAY), 'day']
                    : seconds < MONTH
                        ? [Math.round(seconds / WEEK), 'week']
                        : seconds < YEAR
                            ? [Math.round(seconds / MONTH), 'month']
                            : [Math.round(seconds / YEAR), 'year'];
    return { value, unit, suffix };
};
/**
 * @abstract
 */
class TimeagoFormatter {
}
class TimeagoDefaultFormatter extends TimeagoFormatter {
    /**
     * @param {?} then
     * @return {?}
     */
    format(then) {
        const { suffix, value, unit } = defaultFormattter(then);
        return this.parse(value, unit, suffix);
    }
    /**
     * @param {?} value
     * @param {?} unit
     * @param {?} suffix
     * @return {?}
     */
    parse(value, unit, suffix) {
        if (value !== 1) {
            unit += 's';
        }
        return value + ' ' + unit + ' ' + suffix;
    }
}
TimeagoDefaultFormatter.decorators = [
    { type: Injectable },
];
class TimeagoCustomFormatter extends TimeagoFormatter {
    /**
     * @param {?} intl
     */
    constructor(intl) {
        super();
        this.intl = intl;
    }
    /**
     * @param {?} then
     * @return {?}
     */
    format(then) {
        const { suffix, value, unit } = defaultFormattter(then);
        return this.parse(value, unit, suffix, Date.now(), then);
    }
    /**
     * @param {?} value
     * @param {?} unit
     * @param {?} suffix
     * @param {?} now
     * @param {?} then
     * @return {?}
     */
    parse(value, unit, suffix, now, then) {
        /** convert weeks to days if strings don't handle weeks */
        if (unit === 'week' && !this.intl.strings.week && !this.intl.strings.weeks) {
            const /** @type {?} */ days = Math.round(Math.abs(now - then) / (1000 * 60 * 60 * 24));
            value = days;
            unit = 'day';
        }
        /**
         * create a normalize function for given value
         */
        const /** @type {?} */ normalize = this.normalizeFn(value, now - then, this.intl.strings.numbers);
        /**
         * The eventual return value stored in an array so that the wordSeparator can be used
         */
        const /** @type {?} */ dateString = [];
        /** handle prefixes */
        if (suffix === 'ago' && this.intl.strings.prefixAgo) {
            dateString.push(normalize(this.intl.strings.prefixAgo));
        }
        if (suffix === 'from now' && this.intl.strings.prefixFromNow) {
            dateString.push(normalize(this.intl.strings.prefixFromNow));
        }
        /**
         * Handle Main number and unit
         */
        const /** @type {?} */ isPlural = value > 1;
        if (isPlural) {
            const /** @type {?} */ stringFn = this.intl.strings[unit + 's'] || this.intl.strings[unit] || '%d ' + unit;
            dateString.push(normalize(stringFn));
        }
        else {
            const /** @type {?} */ stringFn = this.intl.strings[unit] || this.intl.strings[unit + 's'] || '%d ' + unit;
            dateString.push(normalize(stringFn));
        }
        /** Handle Suffixes */
        if (suffix === 'ago' && this.intl.strings.suffixAgo) {
            dateString.push(normalize(this.intl.strings.suffixAgo));
        }
        if (suffix === 'from now' && this.intl.strings.suffixFromNow) {
            dateString.push(normalize(this.intl.strings.suffixFromNow));
        }
        /**
         * join the array into a string and return it
         */
        const /** @type {?} */ wordSeparator = typeof this.intl.strings.wordSeparator === 'string' ? this.intl.strings.wordSeparator : ' ';
        return dateString.join(wordSeparator);
    }
    /**
     * If the numbers array is present, format numbers with it,
     * otherwise just cast the number to a string and return it
     * @param {?} numbers
     * @param {?} value
     * @return {?}
     */
    normalizeNumber(numbers, value) {
        return numbers && numbers.length === 10
            ? String(value).split('')
                .map((digit) => digit.match(/^[0-9]$/) ? numbers[parseInt(digit, 10)] : digit)
                .join('')
            : String(value);
    }
    /**
     * Take a string or a function that takes number of days and returns a string
     * and provide a uniform API to create string parts
     * @param {?} value
     * @param {?} millisDelta
     * @param {?=} numbers
     * @return {?}
     */
    normalizeFn(value, millisDelta, numbers) {
        return (stringOrFn) => typeof stringOrFn === 'function'
            ? stringOrFn(value, millisDelta).replace(/%d/g, this.normalizeNumber(numbers, value))
            : stringOrFn.replace(/%d/g, this.normalizeNumber(numbers, value));
    }
}
TimeagoCustomFormatter.decorators = [
    { type: Injectable },
];
/** @nocollapse */
TimeagoCustomFormatter.ctorParameters = () => [
    { type: TimeagoIntl }
];

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
class TimeagoDirective {
    /**
     * @param {?} intl
     * @param {?} cd
     * @param {?} formatter
     * @param {?} element
     * @param {?} clock
     */
    constructor(intl, cd, formatter, element, clock) {
        this.cd = cd;
        this.clock = clock;
        /**
         * Emits on:
         * - Input change
         * - Intl change
         * - Clock tick
         */
        this.stateChanges = new Subject();
        this._live = true;
        if (intl) {
            this.intlSubscription = intl.changes.subscribe(() => this.stateChanges.next());
        }
        this.stateChanges.subscribe(() => {
            this.setContent(element.nativeElement, formatter.format(this.date));
            this.cd.markForCheck();
        });
    }
    /**
     * The Date to display. An actual Date object or something that can be fed to new Date.
     * @return {?}
     */
    get date() {
        return this._date;
    }
    /**
     * @param {?} date
     * @return {?}
     */
    set date(date) {
        this._date = dateParser(date).valueOf();
        if (this._date) {
            if (this.clockSubscription) {
                this.clockSubscription.unsubscribe();
                this.clockSubscription = undefined;
            }
            this.clockSubscription = this.clock.tick(date)
                .pipe(filter(() => this.live, this))
                .subscribe(() => this.stateChanges.next());
        }
        else {
            throw new SyntaxError(`Wrong parameter in TimeagoDirective. Expected a valid date, received: ${date}`);
        }
    }
    /**
     * If the directive should update itself over time
     * @return {?}
     */
    get live() {
        return this._live;
    }
    /**
     * @param {?} live
     * @return {?}
     */
    set live(live) {
        this._live = coerceBooleanProperty(live);
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        this.stateChanges.next();
    }
    /**
     * @param {?} node
     * @param {?} content
     * @return {?}
     */
    setContent(node, content) {
        if (isDefined(node.textContent)) {
            node.textContent = content;
        }
        else {
            node.data = content;
        }
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (this.intlSubscription) {
            this.intlSubscription.unsubscribe();
            this.intlSubscription = undefined;
        }
        if (this.clockSubscription) {
            this.clockSubscription.unsubscribe();
            this.clockSubscription = undefined;
        }
        this.stateChanges.complete();
    }
}
TimeagoDirective.decorators = [
    { type: Directive, args: [{
                selector: '[timeago]',
                exportAs: 'timeago',
            },] },
];
/** @nocollapse */
TimeagoDirective.ctorParameters = () => [
    { type: TimeagoIntl, decorators: [{ type: Optional }] },
    { type: ChangeDetectorRef },
    { type: TimeagoFormatter },
    { type: ElementRef },
    { type: TimeagoClock }
];
TimeagoDirective.propDecorators = {
    date: [{ type: Input }],
    live: [{ type: Input }]
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
class TimeagoPipe {
    /**
     * @param {?} intl
     * @param {?} cd
     * @param {?} formatter
     * @param {?} clock
     */
    constructor(intl, cd, formatter, clock) {
        this.formatter = formatter;
        this.clock = clock;
        this.live = true;
        /**
         * Emits on:
         * - Input change
         * - Intl change
         * - Clock tick
         */
        this.stateChanges = new Subject();
        if (intl) {
            this.intlSubscription = intl.changes.subscribe(() => this.stateChanges.next());
        }
        this.stateChanges.subscribe(() => {
            this.value = formatter.format(this.date);
            cd.markForCheck();
        });
    }
    /**
     * @param {?} date
     * @param {...?} args
     * @return {?}
     */
    transform(date, ...args) {
        const /** @type {?} */ _date = dateParser(date).valueOf();
        let /** @type {?} */ _live;
        _live = isDefined(args[0])
            ? coerceBooleanProperty(args[0])
            : this.live;
        if (this.date === _date && this.live === _live) {
            return this.value;
        }
        this.date = _date;
        this.live = _live;
        if (this.date) {
            if (this.clockSubscription) {
                this.clockSubscription.unsubscribe();
                this.clockSubscription = undefined;
            }
            this.clockSubscription = this.clock.tick(date)
                .pipe(filter(() => this.live, this))
                .subscribe(() => this.stateChanges.next());
            this.stateChanges.next();
        }
        else {
            throw new SyntaxError(`Wrong parameter in TimeagoPipe. Expected a valid date, received: ${date}`);
        }
        return this.value;
    }
    /**
     * @return {?}
     */
    ngOnDestroy() {
        if (this.intlSubscription) {
            this.intlSubscription.unsubscribe();
            this.intlSubscription = undefined;
        }
        if (this.clockSubscription) {
            this.clockSubscription.unsubscribe();
            this.clockSubscription = undefined;
        }
        this.stateChanges.complete();
    }
}
TimeagoPipe.decorators = [
    { type: Injectable },
    { type: Pipe, args: [{
                name: 'timeago',
                pure: false,
            },] },
];
/** @nocollapse */
TimeagoPipe.ctorParameters = () => [
    { type: TimeagoIntl, decorators: [{ type: Optional }] },
    { type: ChangeDetectorRef },
    { type: TimeagoFormatter },
    { type: TimeagoClock }
];

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */
class TimeagoModule {
    /**
     * Use this method in your root module to provide the TimeagoModule
     * @param {?=} config
     * @return {?}
     */
    static forRoot(config = {}) {
        return {
            ngModule: TimeagoModule,
            providers: [
                config.clock || { provide: TimeagoClock, useClass: TimeagoDefaultClock },
                config.intl || [],
                config.formatter || { provide: TimeagoFormatter, useClass: TimeagoDefaultFormatter },
            ],
        };
    }
    /**
     * Use this method in your other (non root) modules to import the directive/pipe
     * @param {?=} config
     * @return {?}
     */
    static forChild(config = {}) {
        return {
            ngModule: TimeagoModule,
            providers: [
                config.clock || { provide: TimeagoClock, useClass: TimeagoDefaultClock },
                config.intl || [],
                config.formatter || { provide: TimeagoFormatter, useClass: TimeagoDefaultFormatter },
            ],
        };
    }
}
TimeagoModule.decorators = [
    { type: NgModule, args: [{
                declarations: [
                    TimeagoDirective,
                    TimeagoPipe,
                ],
                exports: [
                    TimeagoDirective,
                    TimeagoPipe,
                ],
            },] },
];

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

export { TimeagoDirective, TimeagoPipe, TimeagoIntl, TimeagoClock, TimeagoDefaultClock, TimeagoFormatter, TimeagoDefaultFormatter, TimeagoCustomFormatter, TimeagoModule };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXRpbWVhZ28uanMubWFwIiwic291cmNlcyI6WyJuZzovL25neC10aW1lYWdvL3V0aWwudHMiLCJuZzovL25neC10aW1lYWdvL3RpbWVhZ28uY2xvY2sudHMiLCJuZzovL25neC10aW1lYWdvL3RpbWVhZ28uaW50bC50cyIsIm5nOi8vbmd4LXRpbWVhZ28vdGltZWFnby5mb3JtYXR0ZXIudHMiLCJuZzovL25neC10aW1lYWdvL3RpbWVhZ28uZGlyZWN0aXZlLnRzIiwibmc6Ly9uZ3gtdGltZWFnby90aW1lYWdvLnBpcGUudHMiLCJuZzovL25neC10aW1lYWdvL3RpbWVhZ28ubW9kdWxlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBpc0RlZmluZWQodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZSAhPT0gbnVsbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvZXJjZUJvb2xlYW5Qcm9wZXJ0eSh2YWx1ZTogYW55KTogYm9vbGVhbiB7XG4gIHJldHVybiB2YWx1ZSAhPSBudWxsICYmIGAke3ZhbHVlfWAgIT09ICdmYWxzZSc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkYXRlUGFyc2VyKGRhdGU6IGFueSk6IERhdGUge1xuICBjb25zdCBwYXJzZWQgPSBuZXcgRGF0ZShkYXRlKTtcbiAgaWYgKCFOdW1iZXIuaXNOYU4ocGFyc2VkLnZhbHVlT2YoKSkpIHtcbiAgICByZXR1cm4gcGFyc2VkO1xuICB9XG5cbiAgY29uc3QgcGFydHM6IHN0cmluZ1tdID0gU3RyaW5nKGRhdGUpLm1hdGNoKC9cXGQrL2cpO1xuICBpZiAocGFydHMgPT09IG51bGwgfHwgcGFydHMubGVuZ3RoIDw9IDIpIHtcbiAgICByZXR1cm4gcGFyc2VkO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IFtmaXJzdFAsIHNlY29uZFAsIC4uLnJlc3RQc10gPSBwYXJ0cy5tYXAoeCA9PiBwYXJzZUludCh4LCAxMCkpO1xuICAgIHJldHVybiBuZXcgRGF0ZShEYXRlLlVUQyhmaXJzdFAsIHNlY29uZFAgLSAxLCAuLi5yZXN0UHMpKTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgTUlOVVRFID0gNjA7XG5leHBvcnQgY29uc3QgSE9VUiA9IE1JTlVURSAqIDYwO1xuZXhwb3J0IGNvbnN0IERBWSA9IEhPVVIgKiAyNDtcbmV4cG9ydCBjb25zdCBXRUVLID0gREFZICogNztcbmV4cG9ydCBjb25zdCBNT05USCA9IERBWSAqIDMwO1xuZXhwb3J0IGNvbnN0IFlFQVIgPSBEQVkgKiAzNjU7XG4iLCJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiwgZW1wdHksIHRpbWVyIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBleHBhbmQsIHNraXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBNSU5VVEUsIEhPVVIsIERBWSwgV0VFSywgTU9OVEgsIFlFQVIgfSBmcm9tICcuL3V0aWwnO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgVGltZWFnb0Nsb2NrIHtcbiAgYWJzdHJhY3QgdGljayh0aGVuOiBudW1iZXIpOiBPYnNlcnZhYmxlPGFueT47XG59XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBUaW1lYWdvRGVmYXVsdENsb2NrIGV4dGVuZHMgVGltZWFnb0Nsb2NrIHtcbiAgdGljayh0aGVuOiBudW1iZXIpOiBPYnNlcnZhYmxlPG51bWJlcj4ge1xuICAgIHJldHVybiBvZigwKVxuICAgICAgLnBpcGUoXG4gICAgICAgIGV4cGFuZCgoKSA9PiB7XG4gICAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICBjb25zdCBzZWNvbmRzID0gTWF0aC5yb3VuZChNYXRoLmFicyhub3cgLSB0aGVuKSAvIDEwMDApO1xuXG4gICAgICAgICAgY29uc3QgcGVyaW9kID1cbiAgICAgICAgICAgIHNlY29uZHMgPCBNSU5VVEVcbiAgICAgICAgICAgICAgPyAxMDAwXG4gICAgICAgICAgICAgIDogc2Vjb25kcyA8IEhPVVJcbiAgICAgICAgICAgICAgICA/IDEwMDAgKiBNSU5VVEVcbiAgICAgICAgICAgICAgICA6IHNlY29uZHMgPCBEQVlcbiAgICAgICAgICAgICAgICAgID8gMTAwMCAqIEhPVVJcbiAgICAgICAgICAgICAgICAgIDogMDtcblxuICAgICAgICAgIHJldHVybiBwZXJpb2QgPyB0aW1lcihwZXJpb2QpIDogZW1wdHkoKTtcbiAgICAgICAgfSksXG4gICAgICAgIHNraXAoMSlcbiAgICAgICk7XG4gIH1cbn1cbiIsImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IFN0cmluZ09yRm4sIE51bWJlckFycmF5IH0gZnJvbSAnLi90aW1lYWdvLmZvcm1hdHRlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUwxMG5zU3RyaW5ncyB7XG4gIHByZWZpeEFnbz86IFN0cmluZ09yRm47XG4gIHByZWZpeEZyb21Ob3c/OiBTdHJpbmdPckZuO1xuICBzdWZmaXhBZ28/OiBTdHJpbmdPckZuO1xuICBzdWZmaXhGcm9tTm93PzogU3RyaW5nT3JGbjtcbiAgc2Vjb25kPzogU3RyaW5nT3JGbjtcbiAgc2Vjb25kcz86IFN0cmluZ09yRm47XG4gIG1pbnV0ZT86IFN0cmluZ09yRm47XG4gIG1pbnV0ZXM/OiBTdHJpbmdPckZuO1xuICBob3VyPzogU3RyaW5nT3JGbjtcbiAgaG91cnM/OiBTdHJpbmdPckZuO1xuICBkYXk/OiBTdHJpbmdPckZuO1xuICBkYXlzPzogU3RyaW5nT3JGbjtcbiAgd2Vlaz86IFN0cmluZ09yRm47XG4gIHdlZWtzPzogU3RyaW5nT3JGbjtcbiAgbW9udGg/OiBTdHJpbmdPckZuO1xuICBtb250aHM/OiBTdHJpbmdPckZuO1xuICB5ZWFyPzogU3RyaW5nT3JGbjtcbiAgeWVhcnM/OiBTdHJpbmdPckZuO1xuICB3b3JkU2VwYXJhdG9yPzogc3RyaW5nO1xuICBudW1iZXJzPzogTnVtYmVyQXJyYXk7XG59O1xuXG4vKipcbiAqIFRvIG1vZGlmeSB0aGUgdGV4dCBkaXNwbGF5ZWQsIGNyZWF0ZSBhIG5ldyBpbnN0YW5jZSBvZiBUaW1lYWdvSW50bCBhbmRcbiAqIGluY2x1ZGUgaXQgaW4gYSBjdXN0b20gcHJvdmlkZXJcbiAqL1xuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIFRpbWVhZ29JbnRsIHtcblxuICBzdHJpbmdzOiBJTDEwbnNTdHJpbmdzO1xuXG4gIC8qKlxuICAgKiBTdHJlYW0gdGhhdCBlbWl0cyB3aGVuZXZlciB0aGUgbDEwbiBzdHJpbmdzIGFyZSBjaGFuZ2VkXG4gICAqIFVzZSB0aGlzIHRvIG5vdGlmeSBkaXJlY3RpdmVzIGlmIHRoZSBsMTBuIHN0cmluZ3MgaGF2ZSBjaGFuZ2VkIGFmdGVyIGluaXRpYWxpemF0aW9uLlxuICAgKi9cbiAgcmVhZG9ubHkgY2hhbmdlczogU3ViamVjdDx2b2lkPiA9IG5ldyBTdWJqZWN0PHZvaWQ+KCk7XG59XG4iLCJpbXBvcnQgeyBJbmplY3RhYmxlLCBPcHRpb25hbCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgVGltZWFnb0ludGwgfSBmcm9tICcuL3RpbWVhZ28uaW50bCc7XG5pbXBvcnQgeyBNSU5VVEUsIEhPVVIsIERBWSwgV0VFSywgTU9OVEgsIFlFQVIgfSBmcm9tICcuL3V0aWwnO1xuXG5leHBvcnQgdHlwZSBVbml0ID0gJ3NlY29uZCcgfCAnbWludXRlJyB8ICdob3VyJyB8ICdkYXknIHwgJ3dlZWsnIHwgJ21vbnRoJyB8ICd5ZWFyJztcblxuZXhwb3J0IHR5cGUgU3VmZml4ID0gJ2FnbycgfCAnZnJvbSBub3cnO1xuXG5leHBvcnQgdHlwZSBTdHJpbmdPckZuID0gKCh2YWx1ZTogbnVtYmVyLCBtaWxsaXNEZWx0YTogIG51bWJlcikgPT4gc3RyaW5nKSB8IHN0cmluZztcblxuZXhwb3J0IHR5cGUgTnVtYmVyQXJyYXkgPSBbIHN0cmluZywgc3RyaW5nLCBzdHJpbmcsIHN0cmluZywgc3RyaW5nLCBzdHJpbmcsIHN0cmluZywgc3RyaW5nLCBzdHJpbmcsIHN0cmluZyBdO1xuXG5jb25zdCBkZWZhdWx0Rm9ybWF0dHRlciA9IGZ1bmN0aW9uKHRoZW46IG51bWJlcik6IHt2YWx1ZTogbnVtYmVyLCB1bml0OiBVbml0LCBzdWZmaXg6IFN1ZmZpeH0ge1xuICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICBjb25zdCBzZWNvbmRzID0gTWF0aC5yb3VuZChNYXRoLmFicyhub3cgLSB0aGVuKSAvIDEwMDApO1xuICBjb25zdCBzdWZmaXg6IFN1ZmZpeCA9IHRoZW4gPCBub3cgPyAnYWdvJyA6ICdmcm9tIG5vdyc7XG5cbiAgY29uc3QgW3ZhbHVlLCB1bml0XTogW251bWJlciwgVW5pdF0gPVxuICAgIHNlY29uZHMgPCBNSU5VVEVcbiAgICAgID8gW01hdGgucm91bmQoc2Vjb25kcyksICdzZWNvbmQnXVxuICAgICAgOiBzZWNvbmRzIDwgSE9VUlxuICAgICAgICA/IFtNYXRoLnJvdW5kKHNlY29uZHMgLyBNSU5VVEUpLCAnbWludXRlJ11cbiAgICAgICAgOiBzZWNvbmRzIDwgREFZXG4gICAgICAgICAgPyBbTWF0aC5yb3VuZChzZWNvbmRzIC8gSE9VUiksICdob3VyJ11cbiAgICAgICAgICA6IHNlY29uZHMgPCBXRUVLXG4gICAgICAgICAgICA/IFtNYXRoLnJvdW5kKHNlY29uZHMgLyBEQVkpLCAnZGF5J11cbiAgICAgICAgICAgIDogc2Vjb25kcyA8IE1PTlRIXG4gICAgICAgICAgICAgID8gW01hdGgucm91bmQoc2Vjb25kcyAvIFdFRUspLCAnd2VlayddXG4gICAgICAgICAgICAgIDogc2Vjb25kcyA8IFlFQVJcbiAgICAgICAgICAgICAgICA/IFtNYXRoLnJvdW5kKHNlY29uZHMgLyBNT05USCksICdtb250aCddXG4gICAgICAgICAgICAgICAgOiBbTWF0aC5yb3VuZChzZWNvbmRzIC8gWUVBUiksICd5ZWFyJ107XG5cbiAgcmV0dXJuIHt2YWx1ZSwgdW5pdCwgc3VmZml4fTtcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFRpbWVhZ29Gb3JtYXR0ZXIge1xuICBhYnN0cmFjdCBmb3JtYXQodGhlbjogbnVtYmVyKTogc3RyaW5nXG5cbiAgcHJvdGVjdGVkIGFic3RyYWN0IHBhcnNlKHZhbHVlOiBudW1iZXIsIHVuaXQ6IFVuaXQsIHN1ZmZpeDogU3VmZml4LCBub3c/OiBudW1iZXIsIHRoZW4/OiBudW1iZXIpOiBzdHJpbmc7XG59XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBUaW1lYWdvRGVmYXVsdEZvcm1hdHRlciBleHRlbmRzIFRpbWVhZ29Gb3JtYXR0ZXIge1xuICBmb3JtYXQodGhlbjogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCB7c3VmZml4LCB2YWx1ZSwgdW5pdH0gPSBkZWZhdWx0Rm9ybWF0dHRlcih0aGVuKTtcbiAgICByZXR1cm4gdGhpcy5wYXJzZSh2YWx1ZSwgdW5pdCwgc3VmZml4KTtcbiAgfVxuXG4gIHByb3RlY3RlZCBwYXJzZSh2YWx1ZTogbnVtYmVyLCB1bml0OiBVbml0LCBzdWZmaXg6IFN1ZmZpeCk6IHN0cmluZyB7XG4gICAgaWYgKHZhbHVlICE9PSAxKSB7XG4gICAgICB1bml0ICs9ICdzJztcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlICsgJyAnICsgdW5pdCArICcgJyArIHN1ZmZpeDtcbiAgfVxufVxuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgVGltZWFnb0N1c3RvbUZvcm1hdHRlciBleHRlbmRzIFRpbWVhZ29Gb3JtYXR0ZXIge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGludGw6IFRpbWVhZ29JbnRsKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIGZvcm1hdCh0aGVuOiBudW1iZXIpOiBzdHJpbmcge1xuICAgIGNvbnN0IHtzdWZmaXgsIHZhbHVlLCB1bml0fSA9IGRlZmF1bHRGb3JtYXR0dGVyKHRoZW4pO1xuICAgIHJldHVybiB0aGlzLnBhcnNlKHZhbHVlLCB1bml0LCBzdWZmaXgsIERhdGUubm93KCksIHRoZW4pO1xuICB9XG5cbiAgcHJvdGVjdGVkIHBhcnNlKHZhbHVlOiBudW1iZXIsIHVuaXQ6IFVuaXQsIHN1ZmZpeDogU3VmZml4LCBub3c6IG51bWJlciwgdGhlbjogbnVtYmVyKSB7XG4gICAgLyoqIGNvbnZlcnQgd2Vla3MgdG8gZGF5cyBpZiBzdHJpbmdzIGRvbid0IGhhbmRsZSB3ZWVrcyAqL1xuICAgIGlmICh1bml0ID09PSAnd2VlaycgJiYgIXRoaXMuaW50bC5zdHJpbmdzLndlZWsgJiYgIXRoaXMuaW50bC5zdHJpbmdzLndlZWtzKSB7XG4gICAgICBjb25zdCBkYXlzID0gTWF0aC5yb3VuZChNYXRoLmFicyhub3cgLSB0aGVuKSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSk7XG4gICAgICB2YWx1ZSA9IGRheXM7XG4gICAgICB1bml0ID0gJ2RheSc7XG4gICAgfVxuXG4gICAgLyoqIGNyZWF0ZSBhIG5vcm1hbGl6ZSBmdW5jdGlvbiBmb3IgZ2l2ZW4gdmFsdWUgKi9cbiAgICBjb25zdCBub3JtYWxpemUgPSB0aGlzLm5vcm1hbGl6ZUZuKHZhbHVlLCBub3cgLSB0aGVuLCB0aGlzLmludGwuc3RyaW5ncy5udW1iZXJzKTtcblxuICAgIC8qKiBUaGUgZXZlbnR1YWwgcmV0dXJuIHZhbHVlIHN0b3JlZCBpbiBhbiBhcnJheSBzbyB0aGF0IHRoZSB3b3JkU2VwYXJhdG9yIGNhbiBiZSB1c2VkICovXG4gICAgY29uc3QgZGF0ZVN0cmluZzogc3RyaW5nW10gPSBbXTtcblxuICAgIC8qKiBoYW5kbGUgcHJlZml4ZXMgKi9cbiAgICBpZiAoc3VmZml4ID09PSAnYWdvJyAmJiB0aGlzLmludGwuc3RyaW5ncy5wcmVmaXhBZ28pIHtcbiAgICAgIGRhdGVTdHJpbmcucHVzaChub3JtYWxpemUodGhpcy5pbnRsLnN0cmluZ3MucHJlZml4QWdvKSk7XG4gICAgfVxuICAgIGlmIChzdWZmaXggPT09ICdmcm9tIG5vdycgJiYgdGhpcy5pbnRsLnN0cmluZ3MucHJlZml4RnJvbU5vdykge1xuICAgICAgZGF0ZVN0cmluZy5wdXNoKG5vcm1hbGl6ZSh0aGlzLmludGwuc3RyaW5ncy5wcmVmaXhGcm9tTm93KSk7XG4gICAgfVxuXG4gICAgLyoqIEhhbmRsZSBNYWluIG51bWJlciBhbmQgdW5pdCAqL1xuICAgIGNvbnN0IGlzUGx1cmFsID0gdmFsdWUgPiAxO1xuICAgIGlmIChpc1BsdXJhbCkge1xuICAgICAgY29uc3Qgc3RyaW5nRm46IFN0cmluZ09yRm4gPSB0aGlzLmludGwuc3RyaW5nc1t1bml0ICsgJ3MnXSB8fCB0aGlzLmludGwuc3RyaW5nc1t1bml0XSB8fCAnJWQgJyArIHVuaXQ7XG4gICAgICBkYXRlU3RyaW5nLnB1c2gobm9ybWFsaXplKHN0cmluZ0ZuKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHN0cmluZ0ZuOiBTdHJpbmdPckZuID0gdGhpcy5pbnRsLnN0cmluZ3NbdW5pdF0gfHwgdGhpcy5pbnRsLnN0cmluZ3NbdW5pdCArICdzJ10gfHwgJyVkICcgKyB1bml0O1xuICAgICAgZGF0ZVN0cmluZy5wdXNoKG5vcm1hbGl6ZShzdHJpbmdGbikpO1xuICAgIH1cblxuICAgIC8qKiBIYW5kbGUgU3VmZml4ZXMgKi9cbiAgICBpZiAoc3VmZml4ID09PSAnYWdvJyAmJiB0aGlzLmludGwuc3RyaW5ncy5zdWZmaXhBZ28pIHtcbiAgICAgIGRhdGVTdHJpbmcucHVzaChub3JtYWxpemUodGhpcy5pbnRsLnN0cmluZ3Muc3VmZml4QWdvKSk7XG4gICAgfVxuICAgIGlmIChzdWZmaXggPT09ICdmcm9tIG5vdycgJiYgdGhpcy5pbnRsLnN0cmluZ3Muc3VmZml4RnJvbU5vdykge1xuICAgICAgZGF0ZVN0cmluZy5wdXNoKG5vcm1hbGl6ZSh0aGlzLmludGwuc3RyaW5ncy5zdWZmaXhGcm9tTm93KSk7XG4gICAgfVxuXG4gICAgLyoqIGpvaW4gdGhlIGFycmF5IGludG8gYSBzdHJpbmcgYW5kIHJldHVybiBpdCAqL1xuICAgIGNvbnN0IHdvcmRTZXBhcmF0b3IgPSB0eXBlb2YgdGhpcy5pbnRsLnN0cmluZ3Mud29yZFNlcGFyYXRvciA9PT0gJ3N0cmluZycgPyB0aGlzLmludGwuc3RyaW5ncy53b3JkU2VwYXJhdG9yIDogJyAnO1xuICAgIHJldHVybiBkYXRlU3RyaW5nLmpvaW4od29yZFNlcGFyYXRvcik7XG4gIH1cblxuICAvKipcbiAgICogSWYgdGhlIG51bWJlcnMgYXJyYXkgaXMgcHJlc2VudCwgZm9ybWF0IG51bWJlcnMgd2l0aCBpdCxcbiAgICogb3RoZXJ3aXNlIGp1c3QgY2FzdCB0aGUgbnVtYmVyIHRvIGEgc3RyaW5nIGFuZCByZXR1cm4gaXRcbiAgKi9cbiAgcHJpdmF0ZSBub3JtYWxpemVOdW1iZXIobnVtYmVyczogTnVtYmVyQXJyYXksIHZhbHVlOiBudW1iZXIpIHtcbiAgICByZXR1cm4gbnVtYmVycyAmJiBudW1iZXJzLmxlbmd0aCA9PT0gMTBcbiAgICAgID8gU3RyaW5nKHZhbHVlKS5zcGxpdCgnJylcbiAgICAgICAgICAubWFwKChkaWdpdDogc3RyaW5nKSA9PiBkaWdpdC5tYXRjaCgvXlswLTldJC8pID8gbnVtYmVyc1twYXJzZUludChkaWdpdCwgMTApXSA6IGRpZ2l0KVxuICAgICAgICAgIC5qb2luKCcnKVxuICAgICAgOiBTdHJpbmcodmFsdWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRha2UgYSBzdHJpbmcgb3IgYSBmdW5jdGlvbiB0aGF0IHRha2VzIG51bWJlciBvZiBkYXlzIGFuZCByZXR1cm5zIGEgc3RyaW5nXG4gICAqIGFuZCBwcm92aWRlIGEgdW5pZm9ybSBBUEkgdG8gY3JlYXRlIHN0cmluZyBwYXJ0c1xuICAqL1xuICBwcml2YXRlIG5vcm1hbGl6ZUZuKHZhbHVlOiBudW1iZXIsIG1pbGxpc0RlbHRhOiBudW1iZXIsIG51bWJlcnM/OiBOdW1iZXJBcnJheSkge1xuICAgIHJldHVybiAoc3RyaW5nT3JGbjogU3RyaW5nT3JGbikgPT5cbiAgICAgIHR5cGVvZiBzdHJpbmdPckZuID09PSAnZnVuY3Rpb24nXG4gICAgICA/IHN0cmluZ09yRm4odmFsdWUsIG1pbGxpc0RlbHRhKS5yZXBsYWNlKC8lZC9nLCB0aGlzLm5vcm1hbGl6ZU51bWJlcihudW1iZXJzLCB2YWx1ZSkpXG4gICAgICA6IHN0cmluZ09yRm4ucmVwbGFjZSgvJWQvZywgdGhpcy5ub3JtYWxpemVOdW1iZXIobnVtYmVycywgdmFsdWUpKTtcbiAgfVxufVxuIiwiaW1wb3J0IHtcbiAgRGlyZWN0aXZlLFxuICBJbnB1dCxcbiAgRWxlbWVudFJlZixcbiAgT3B0aW9uYWwsXG4gIFNpbXBsZUNoYW5nZXMsXG4gIE9uQ2hhbmdlcyxcbiAgT25EZXN0cm95LFxuICBDaGFuZ2VEZXRlY3RvclJlZlxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiwgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgZmlsdGVyIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgVGltZWFnb0Nsb2NrIH0gZnJvbSAnLi90aW1lYWdvLmNsb2NrJztcbmltcG9ydCB7IFRpbWVhZ29Gb3JtYXR0ZXIgfSBmcm9tICcuL3RpbWVhZ28uZm9ybWF0dGVyJztcbmltcG9ydCB7IFRpbWVhZ29JbnRsIH0gZnJvbSAnLi90aW1lYWdvLmludGwnO1xuaW1wb3J0IHsgaXNEZWZpbmVkLCBjb2VyY2VCb29sZWFuUHJvcGVydHksIGRhdGVQYXJzZXIgfSBmcm9tICcuL3V0aWwnO1xuXG5ARGlyZWN0aXZlKHtcbiAgc2VsZWN0b3I6ICdbdGltZWFnb10nLFxuICBleHBvcnRBczogJ3RpbWVhZ28nLFxufSlcbmV4cG9ydCBjbGFzcyBUaW1lYWdvRGlyZWN0aXZlIGltcGxlbWVudHMgT25DaGFuZ2VzLCBPbkRlc3Ryb3kge1xuICBwcml2YXRlIGludGxTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcbiAgcHJpdmF0ZSBjbG9ja1N1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuXG4gIC8qKlxuICAgKiBFbWl0cyBvbjpcbiAgICogLSBJbnB1dCBjaGFuZ2VcbiAgICogLSBJbnRsIGNoYW5nZVxuICAgKiAtIENsb2NrIHRpY2tcbiAgKi9cbiAgc3RhdGVDaGFuZ2VzID0gbmV3IFN1YmplY3Q8YW55PigpO1xuXG4gIC8qKiBUaGUgRGF0ZSB0byBkaXNwbGF5LiBBbiBhY3R1YWwgRGF0ZSBvYmplY3Qgb3Igc29tZXRoaW5nIHRoYXQgY2FuIGJlIGZlZCB0byBuZXcgRGF0ZS4gKi9cbiAgQElucHV0KClcbiAgZ2V0IGRhdGUoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5fZGF0ZTtcbiAgfVxuICBzZXQgZGF0ZShkYXRlOiBudW1iZXIpIHtcbiAgICB0aGlzLl9kYXRlID0gZGF0ZVBhcnNlcihkYXRlKS52YWx1ZU9mKCk7XG4gICAgaWYgKHRoaXMuX2RhdGUpIHtcbiAgICAgIGlmICh0aGlzLmNsb2NrU3Vic2NyaXB0aW9uKSB7XG4gICAgICAgIHRoaXMuY2xvY2tTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgdGhpcy5jbG9ja1N1YnNjcmlwdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICAgIHRoaXMuY2xvY2tTdWJzY3JpcHRpb24gPSB0aGlzLmNsb2NrLnRpY2soZGF0ZSlcbiAgICAgICAgLnBpcGUoZmlsdGVyKCgpID0+IHRoaXMubGl2ZSwgdGhpcykpXG4gICAgICAgIC5zdWJzY3JpYmUoKCkgPT4gdGhpcy5zdGF0ZUNoYW5nZXMubmV4dCgpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IFN5bnRheEVycm9yKGBXcm9uZyBwYXJhbWV0ZXIgaW4gVGltZWFnb0RpcmVjdGl2ZS4gRXhwZWN0ZWQgYSB2YWxpZCBkYXRlLCByZWNlaXZlZDogJHtkYXRlfWApO1xuICAgIH1cbiAgfVxuICBwcml2YXRlIF9kYXRlOiBudW1iZXI7XG5cbiAgLyoqIElmIHRoZSBkaXJlY3RpdmUgc2hvdWxkIHVwZGF0ZSBpdHNlbGYgb3ZlciB0aW1lICovXG4gIEBJbnB1dCgpXG4gIGdldCBsaXZlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9saXZlO1xuICB9XG4gIHNldCBsaXZlKGxpdmU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl9saXZlID0gY29lcmNlQm9vbGVhblByb3BlcnR5KGxpdmUpO1xuICB9XG4gIHByaXZhdGUgX2xpdmUgPSB0cnVlO1xuXG4gIGNvbnN0cnVjdG9yKEBPcHRpb25hbCgpIGludGw6IFRpbWVhZ29JbnRsLFxuICAgICAgICAgICAgICBwcml2YXRlIGNkOiBDaGFuZ2VEZXRlY3RvclJlZixcbiAgICAgICAgICAgICAgZm9ybWF0dGVyOiBUaW1lYWdvRm9ybWF0dGVyLFxuICAgICAgICAgICAgICBlbGVtZW50OiBFbGVtZW50UmVmLFxuICAgICAgICAgICAgICBwcml2YXRlIGNsb2NrOiBUaW1lYWdvQ2xvY2spIHtcbiAgICBpZiAoaW50bCkge1xuICAgICAgdGhpcy5pbnRsU3Vic2NyaXB0aW9uID0gaW50bC5jaGFuZ2VzLnN1YnNjcmliZSgoKSA9PiB0aGlzLnN0YXRlQ2hhbmdlcy5uZXh0KCkpO1xuICAgIH1cbiAgICB0aGlzLnN0YXRlQ2hhbmdlcy5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgdGhpcy5zZXRDb250ZW50KGVsZW1lbnQubmF0aXZlRWxlbWVudCwgZm9ybWF0dGVyLmZvcm1hdCh0aGlzLmRhdGUpKTtcbiAgICAgIHRoaXMuY2QubWFya0ZvckNoZWNrKCk7XG4gICAgfSk7XG4gIH1cblxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XG4gICAgdGhpcy5zdGF0ZUNoYW5nZXMubmV4dCgpO1xuICB9XG5cbiAgc2V0Q29udGVudChub2RlOiBhbnksIGNvbnRlbnQ6IHN0cmluZykge1xuICAgIGlmIChpc0RlZmluZWQobm9kZS50ZXh0Q29udGVudCkpIHtcbiAgICAgIG5vZGUudGV4dENvbnRlbnQgPSBjb250ZW50O1xuICAgIH0gZWxzZSB7XG4gICAgICBub2RlLmRhdGEgPSBjb250ZW50O1xuICAgIH1cbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIGlmICh0aGlzLmludGxTdWJzY3JpcHRpb24pIHtcbiAgICAgIHRoaXMuaW50bFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgdGhpcy5pbnRsU3Vic2NyaXB0aW9uID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBpZiAodGhpcy5jbG9ja1N1YnNjcmlwdGlvbikge1xuICAgICAgdGhpcy5jbG9ja1N1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgdGhpcy5jbG9ja1N1YnNjcmlwdGlvbiA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgdGhpcy5zdGF0ZUNoYW5nZXMuY29tcGxldGUoKTtcbiAgfVxufVxuIiwiaW1wb3J0IHtcbiAgSW5qZWN0YWJsZSxcbiAgT25EZXN0cm95LFxuICBQaXBlLFxuICBQaXBlVHJhbnNmb3JtLFxuICBPcHRpb25hbCxcbiAgQ2hhbmdlRGV0ZWN0b3JSZWZcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBTdWJzY3JpcHRpb24sIFN1YmplY3QgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IFRpbWVhZ29DbG9jayB9IGZyb20gJy4vdGltZWFnby5jbG9jayc7XG5pbXBvcnQgeyBUaW1lYWdvRm9ybWF0dGVyIH0gZnJvbSAnLi90aW1lYWdvLmZvcm1hdHRlcic7XG5pbXBvcnQgeyBUaW1lYWdvSW50bCB9IGZyb20gJy4vdGltZWFnby5pbnRsJztcbmltcG9ydCB7IGlzRGVmaW5lZCwgY29lcmNlQm9vbGVhblByb3BlcnR5LCBkYXRlUGFyc2VyIH0gZnJvbSAnLi91dGlsJztcbmltcG9ydCB7IGZpbHRlciB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuQEluamVjdGFibGUoKVxuQFBpcGUoe1xuICBuYW1lOiAndGltZWFnbycsXG4gIHB1cmU6IGZhbHNlLCAvLyByZXF1aXJlZCB0byB1cGRhdGUgdGhlIHZhbHVlIHdoZW4gc3RhdGVDaGFuZ2VzIGVtaXRzXG59KVxuZXhwb3J0IGNsYXNzIFRpbWVhZ29QaXBlIGltcGxlbWVudHMgUGlwZVRyYW5zZm9ybSwgT25EZXN0cm95IHtcbiAgcHJpdmF0ZSBpbnRsU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XG4gIHByaXZhdGUgY2xvY2tTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcblxuICBwcml2YXRlIGRhdGU6IG51bWJlcjtcbiAgcHJpdmF0ZSB2YWx1ZTogc3RyaW5nO1xuICBwcml2YXRlIGxpdmUgPSB0cnVlO1xuXG4gIC8qKlxuICAgKiBFbWl0cyBvbjpcbiAgICogLSBJbnB1dCBjaGFuZ2VcbiAgICogLSBJbnRsIGNoYW5nZVxuICAgKiAtIENsb2NrIHRpY2tcbiAgKi9cbiAgc3RhdGVDaGFuZ2VzID0gbmV3IFN1YmplY3Q8dm9pZD4oKTtcblxuICBjb25zdHJ1Y3RvcihAT3B0aW9uYWwoKSBpbnRsOiBUaW1lYWdvSW50bCxcbiAgICBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgcHJpdmF0ZSBmb3JtYXR0ZXI6IFRpbWVhZ29Gb3JtYXR0ZXIsXG4gICAgcHJpdmF0ZSBjbG9jazogVGltZWFnb0Nsb2NrKSB7XG4gICAgaWYgKGludGwpIHtcbiAgICAgIHRoaXMuaW50bFN1YnNjcmlwdGlvbiA9IGludGwuY2hhbmdlcy5zdWJzY3JpYmUoKCkgPT4gdGhpcy5zdGF0ZUNoYW5nZXMubmV4dCgpKTtcbiAgICB9XG4gICAgdGhpcy5zdGF0ZUNoYW5nZXMuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgIHRoaXMudmFsdWUgPSBmb3JtYXR0ZXIuZm9ybWF0KHRoaXMuZGF0ZSk7XG4gICAgICBjZC5tYXJrRm9yQ2hlY2soKTtcbiAgICB9KTtcbiAgfVxuXG4gIHRyYW5zZm9ybShkYXRlOiBudW1iZXIsIC4uLmFyZ3M6IGFueVtdKSB7XG4gICAgY29uc3QgX2RhdGUgPSBkYXRlUGFyc2VyKGRhdGUpLnZhbHVlT2YoKTtcbiAgICBsZXQgX2xpdmU6IGJvb2xlYW47XG5cbiAgICBfbGl2ZSA9IGlzRGVmaW5lZChhcmdzWzBdKVxuICAgICAgPyBjb2VyY2VCb29sZWFuUHJvcGVydHkoYXJnc1swXSlcbiAgICAgIDogdGhpcy5saXZlO1xuXG4gICAgaWYgKHRoaXMuZGF0ZSA9PT0gX2RhdGUgJiYgdGhpcy5saXZlID09PSBfbGl2ZSkge1xuICAgICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gICAgfVxuXG4gICAgdGhpcy5kYXRlID0gX2RhdGU7XG4gICAgdGhpcy5saXZlID0gX2xpdmU7XG5cbiAgICBpZiAodGhpcy5kYXRlKSB7XG4gICAgICBpZiAodGhpcy5jbG9ja1N1YnNjcmlwdGlvbikge1xuICAgICAgICB0aGlzLmNsb2NrU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIHRoaXMuY2xvY2tTdWJzY3JpcHRpb24gPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICB0aGlzLmNsb2NrU3Vic2NyaXB0aW9uID0gdGhpcy5jbG9jay50aWNrKGRhdGUpXG4gICAgICAgIC5waXBlKGZpbHRlcigoKSA9PiB0aGlzLmxpdmUsIHRoaXMpKVxuICAgICAgICAuc3Vic2NyaWJlKCgpID0+IHRoaXMuc3RhdGVDaGFuZ2VzLm5leHQoKSk7XG4gICAgICB0aGlzLnN0YXRlQ2hhbmdlcy5uZXh0KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBTeW50YXhFcnJvcihgV3JvbmcgcGFyYW1ldGVyIGluIFRpbWVhZ29QaXBlLiBFeHBlY3RlZCBhIHZhbGlkIGRhdGUsIHJlY2VpdmVkOiAke2RhdGV9YCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMudmFsdWU7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpIHtcbiAgICBpZiAodGhpcy5pbnRsU3Vic2NyaXB0aW9uKSB7XG4gICAgICB0aGlzLmludGxTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgIHRoaXMuaW50bFN1YnNjcmlwdGlvbiA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgaWYgKHRoaXMuY2xvY2tTdWJzY3JpcHRpb24pIHtcbiAgICAgIHRoaXMuY2xvY2tTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgIHRoaXMuY2xvY2tTdWJzY3JpcHRpb24gPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHRoaXMuc3RhdGVDaGFuZ2VzLmNvbXBsZXRlKCk7XG4gIH1cbn1cbiIsImltcG9ydCB7IE5nTW9kdWxlLCBNb2R1bGVXaXRoUHJvdmlkZXJzLCBQcm92aWRlciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgVGltZWFnb0RpcmVjdGl2ZSB9IGZyb20gJy4vdGltZWFnby5kaXJlY3RpdmUnO1xuaW1wb3J0IHsgVGltZWFnb1BpcGUgfSBmcm9tICcuL3RpbWVhZ28ucGlwZSc7XG5pbXBvcnQgeyBUaW1lYWdvSW50bCB9IGZyb20gJy4vdGltZWFnby5pbnRsJztcbmltcG9ydCB7IFRpbWVhZ29DbG9jaywgVGltZWFnb0RlZmF1bHRDbG9jayB9IGZyb20gJy4vdGltZWFnby5jbG9jayc7XG5pbXBvcnQgeyBUaW1lYWdvRm9ybWF0dGVyLCBUaW1lYWdvRGVmYXVsdEZvcm1hdHRlciB9IGZyb20gJy4vdGltZWFnby5mb3JtYXR0ZXInO1xuXG5leHBvcnQgaW50ZXJmYWNlIFRpbWVhZ29Nb2R1bGVDb25maWcge1xuICBjbG9jaz86IFByb3ZpZGVyO1xuICBpbnRsPzogUHJvdmlkZXI7XG4gIGZvcm1hdHRlcj86IFByb3ZpZGVyO1xufVxuXG5ATmdNb2R1bGUoe1xuICBkZWNsYXJhdGlvbnM6IFtcbiAgICBUaW1lYWdvRGlyZWN0aXZlLFxuICAgIFRpbWVhZ29QaXBlLFxuICBdLFxuICBleHBvcnRzOiBbXG4gICAgVGltZWFnb0RpcmVjdGl2ZSxcbiAgICBUaW1lYWdvUGlwZSxcbiAgXSxcbn0pXG5leHBvcnQgY2xhc3MgVGltZWFnb01vZHVsZSB7XG4gIC8qKlxuICAgKiBVc2UgdGhpcyBtZXRob2QgaW4geW91ciByb290IG1vZHVsZSB0byBwcm92aWRlIHRoZSBUaW1lYWdvTW9kdWxlXG4gICAqL1xuICBzdGF0aWMgZm9yUm9vdChjb25maWc6IFRpbWVhZ29Nb2R1bGVDb25maWcgPSB7fSk6IE1vZHVsZVdpdGhQcm92aWRlcnMge1xuICAgIHJldHVybiB7XG4gICAgICBuZ01vZHVsZTogVGltZWFnb01vZHVsZSxcbiAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICBjb25maWcuY2xvY2sgfHwge3Byb3ZpZGU6IFRpbWVhZ29DbG9jaywgdXNlQ2xhc3M6IFRpbWVhZ29EZWZhdWx0Q2xvY2t9LFxuICAgICAgICBjb25maWcuaW50bCB8fCBbXSxcbiAgICAgICAgY29uZmlnLmZvcm1hdHRlciB8fCB7cHJvdmlkZTogVGltZWFnb0Zvcm1hdHRlciwgdXNlQ2xhc3M6IFRpbWVhZ29EZWZhdWx0Rm9ybWF0dGVyfSxcbiAgICAgIF0sXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2UgdGhpcyBtZXRob2QgaW4geW91ciBvdGhlciAobm9uIHJvb3QpIG1vZHVsZXMgdG8gaW1wb3J0IHRoZSBkaXJlY3RpdmUvcGlwZVxuICAgKi9cbiAgc3RhdGljIGZvckNoaWxkKGNvbmZpZzogVGltZWFnb01vZHVsZUNvbmZpZyA9IHt9KTogTW9kdWxlV2l0aFByb3ZpZGVycyB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5nTW9kdWxlOiBUaW1lYWdvTW9kdWxlLFxuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIGNvbmZpZy5jbG9jayB8fCB7cHJvdmlkZTogVGltZWFnb0Nsb2NrLCB1c2VDbGFzczogVGltZWFnb0RlZmF1bHRDbG9ja30sXG4gICAgICAgIGNvbmZpZy5pbnRsIHx8IFtdLFxuICAgICAgICBjb25maWcuZm9ybWF0dGVyIHx8IHtwcm92aWRlOiBUaW1lYWdvRm9ybWF0dGVyLCB1c2VDbGFzczogVGltZWFnb0RlZmF1bHRGb3JtYXR0ZXJ9LFxuICAgICAgXSxcbiAgICB9O1xuICB9XG59XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQUEsbUJBQTBCLEtBQVU7SUFDbEMsT0FBTyxPQUFPLEtBQUssS0FBSyxXQUFXLElB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